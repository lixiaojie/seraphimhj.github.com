--- 
status: publish
layout: post
title: !binary |
  5aSn5a625LiA6LW355SoZ3Rr57yW56iLNQ==

meta: 
  _jd_wp_twitter: "Post Edited: \xE5\xA4\xA7\xE5\xAE\xB6\xE4\xB8\x80\xE8\xB5\xB7\xE7\x94\xA8gtk\xE7\xBC\x96\xE7\xA8\x8B5 http://huangjian.info/193/gtk_program_5_window/"
  _wp_jd_bitly: ""
  _wp_jd_clig: ""
  _wp_jd_wp: http://huangjian.info/193/gtk_program_5_window/
  _edit_last: "1"
  _wp_old_slug: ""
  _wp_jd_yourls: ""
  _jd_post_meta_fixed: "true"
  _wp_jd_target: http://huangjian.info/193/gtk_program_5_window/
  _wp_jd_url: ""
  _jd_twitter: ""
  _jd_tweet_this: "yes"
tags: 
- gtk
- Program
- Technics
published: true
type: post
---
<ul></br>
	<li>7、窗口布局初探</li></br>
</ul></br>
<p align="left">上回说到如何使用gdb来调试我们的程序，这回简单地介绍下如何有效地进行窗口布局，这也将是gtk编程基础入门的最后一部分；在接下来的日子里，笔者将针对gtk中的所有内容分专题，对每一部分都进行详细并且深入的描述，好了，进入今天的主题。</p></br>
<p align="left"><!--more--></p></br>
</br>
<table width="100%" border="1" cellspacing="1" cellpadding="0"></br>
<tbody></br>
<tr></br>
<td></br>
<p align="center">hello_box.c</p></br>
</td></br>
</tr></br>
<tr></br>
<td></br>
<p align="left">/* 本例的主要目的是在主窗口中旋转一个box控件，再在box控件中</br>
* 放置一个单行编辑框和一个按钮</br>
* 并且单击按钮退出程序</br>
*/</br>
#include&lt;gtk/gtk.h&gt;//按钮“button”的回调函数</br>
void</br>
cb_button(GtkWidget *widget, gpointer data)</br>
{//cb = call back</br>
g_print(“你单击了按钮\n”);</br>
gtk_main_quit();</br>
}</p></br>
<p align="left">int</br>
main(int argc, char *argv[])</br>
{</br>
GtkWidget *main_window; //主窗口对象</br>
GtkWidget *hbox, *button, *editor;</p></br>
<p align="left">gtk_init(&amp;argc, &amp;argv);</p></br>
<p align="left">main_window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</br>
g_signal_connect(G_OBJECT(main_window), “destroy”, G_CALLBACK(gtk_main_quit), NULL);</br>
gtk_window_set_title(GTK_WINDOW(main_window), “Hello,Dubuntu2!”);</br>
gtk_window_set_default_size(GTK_WINDOW(main_window), 200,50);</p></br>
<p align="left">button = gtk_button_new_with_label(“退出程序”);</br>
g_signal_connect(G_OBJECT(button), “clicked”, G_CALLBACK(cb_button),NULL);</p></br>
<p align="left">editor = gtk_entry_new();</p></br>
<p align="left">hbox = gtk_hbox_new(FALSE, 10);</p></br>
<p align="left">gtk_box_pack_start(GTK_BOX(hbox), editor, TRUE, TRUE, 10);</br>
gtk_box_pack_start(GTK_BOX(hbox), button, FALSE, FALSE, 10);</br>
gtk_container_add(GTK_CONTAINER(main_window), hbox);</p></br>
<p align="left">gtk_widget_show_all(main_window);</p></br>
<p align="left">gtk_main();</br>
return 0;</p></br>
</td></br>
</tr></br>
<tr></br>
<td></br>
<p align="left">编程程序：gcc -o hello_box  hello_box.c  `pkg-config –cflags gtk+-2.0` -g -Wall</br>
运行程序：./hello_box</p></br>
</td></br>
</tr></br>
</tbody></br>
</table></br>
<p align="left">组件之间的关系：</p></br>
<p align="center"></p></br>
<p align="left">程序注释：</br>
1）几个新增函数：</p></br>
</br>
<ul></br>
	<li>g_print(“你单击了按钮\n”); ：这是 glib 库提供的面向控制台的输出函数，其功能同标准C的 printf() 差不多，但在gtk程序中使用g_print()更具可移值性。</li></br>
	<li>gtk_entry_new()：构造一个“单行文本输入框” 对象并返回此对象的指针。</li></br>
	<li>gtk_hbox_new()：构造一个“水平”的盒子，用来装 单行输入框和按钮“</li></br>
	<li>gtk_box_pack_start()：往盒子中”装“东西（这里是 enter 和 button)</li></br>
	<li>gtk_widget_show_all(main_window)：显示 main_window 中的所有对象。</li></br>
</ul></br>
<div align="center"></br>
<table width="80%" border="1" cellpadding="0"></br>
<tbody></br>
<tr></br>
<td></br>
<p align="left">小道消息：在gtk中，所有创建对象的函数都是 ”gtk_对象名_new()“ 的形式</p></br>
</td></br>
</tr></br>
</tbody></br>
</table></br>
</div></br>
<p align="left">2）什么是 box？</br>
box是一种不可视（就是看不见）的对象，为什么会有box呢？</br>
Gtk在对待控件大小这点上，同 VC/VB/Delphi/PB/Qt 等都是不一样的，在前边这几个语言中，一般情况下，界面设计好后，其所有对象的大小都是固定的，也就是说不会因为屏幕分辨率或窗口大小发生变化而自动适应 这些变化（要实现自适应的功能也很麻烦）。而在 gtk 或者 Java 中，控件在窗口中的位置是个相对值，程序将根据当前环境自动调整控件的新位置，具体的调整方法是可以通过程序预设的。</p></br>
<p align="left">box是一种”长条形“的盒子，有”垂直”和“水平”两种，分别使用 gtk_hbox_new() 和 gtk_vbox_new() 来创建，可以往“盒子”里面放入一个或多个其它的控件，这是使用gtk_box_pack_start()函数实现的，当然，“盒子”里面也可以放入其它 的“盒子”，这就是gtk界面布局的关键，一般的gtk程序都是这样盒子套盒子再套盒子，在各个盒子中放入按钮，输入框，菜单等控件，这样就构成了一个复 杂的界面。</p></br>
<p align="left">当然，界面布局也可以使用 table ，但用得最多的还是 box。</p></br>
<p align="left">3）gtk_hbox_new()</p></br>
</br>
<table width="485" border="1" cellspacing="1" cellpadding="0"></br>
<tbody></br>
<tr></br>
<td></br>
<p align="left"><span style="text-decoration: underline;">GtkWidget</span>*  gtk_hbox_new   (gboolean homogeneous,</p></br>
<p align="left">                            gint spacing);</p></br>
<p align="left">功能：创建一个新的水平 box 控件</p></br>
<p align="left">参数： homogeneous：如果值为“TRUE”则所有放进去的控件都分配相同的大小</p></br>
<p align="left">      spacing：相邻控件之间的间距，单位为像素(pixel)</p></br>
<p align="left">返回值：新创建的控件的指针。、</p></br>
</td></br>
</tr></br>
</tbody></br>
</table></br>
<p align="left">与之对应的 gtk_vbox_new() 用法完全相同。</p></br>
<p align="left">4）gtk_box_pack_start()</p></br>
</br>
<table width="486" border="1" cellspacing="1" cellpadding="0"></br>
<tbody></br>
<tr></br>
<td></br>
<p align="left">void   gtk_box_pack_start     (<span style="text-decoration: underline;">GtkBox</span>*box,</p></br>
<p align="left">                               <span style="text-decoration: underline;">GtkWidget</span>*child,</p></br>
<p align="left">                               gboolean expand,</p></br>
<p align="left">                               gboolean fill,</p></br>
<p align="left">                               guint padding);</p></br>
<p align="left">功能：往“box”中放入一个控件</p></br>
<p align="left">参数： box：就是往这个“box”中放入新的控件</br>
child：就是放入这个控件</br>
expand 和 fill：笔者始终认为这两个参数只可意会，不可言传</br>
padding：指示同 “child” 控件相邻控件之间的间距（单位为像素 pixel）</p></br>
</td></br>
</tr></br>
</tbody></br>
</table></br>
<p align="left">5）GTK_BOX(object) 宏</br>
这个宏用来将 object 参数强制转换为 GtkBox 对象（当然，也进行类型检查），gtk中所有的对象都有相似的宏，比如GtkWindow对象有GTK_WINDOW()宏，GtkButton对象有GTK_BUTTON()宏等。</p></br>
<p align="left">好了，今天的内容就到这里，读者可以自己修改 “gtk_hbox_new 和 gtk_box_pack_start“中的各个参数的值，然后重新编译运行程序，根据运行效果来体会各个参数的关系吧。</p></br>
<p align="left">推荐： devhelp 帮助，在编程中有不清楚的gtk函数或宏，可随时通过它查询。</p></br>
<p align="left">入门部分结束，笔者的文笔是很烂的，也不知道前边的内容写得怎么样，希望大家能够看明白；在接下来的日子里，我们会分别详细地介绍各个 gtk 控件（可视的与不可视的），并且尽可能写些小示例来演示一些控件或接口函数的功能； 在介绍完控件后，还有 glib 专题，”国际化/本地华“专题， glade 专题，解析 hypersrc 这个源代码浏览软件。</p></br>
&nbsp;
