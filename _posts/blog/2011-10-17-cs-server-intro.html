--- 
status: publish
layout: post
title: CS服务器处理步骤
tags: Technics
published: true
type: post
---
<h4>服务器的处理步骤</h4></br>
<blockquote>解析浏览器的请求，在服务目录中查找相应的文件，如果找不到该文件就返回404错误页面;</br>
</br>如果找到了浏览器请求的文件，用stat(2)检查它是否可执行。</br>
</blockquote></br>
<blockquote></br>
如果该文件可执行：</br>
        	<li>发送HTTP/1.1 200 OK给客户端</li></br>
     	        <li>fork(2)，然后用dup2(2)重定向子进程的标准输出到客户端socket</li></br>
        	<li>在子进程中exec(3)该CGI程序</li></br>
        	<li>关闭连接</li></br>
</blockquote></br>
<blockquote></br>
如果该文件不可执行：</br>
<li>发送HTTP/1.1 200 OK给客户端</li></br>
        	<li>如果是一个图片文件，根据图片的扩展名发送相应的Content-Type给客户端</li></br>
        	<li>如果不是图片文件，这里我们简化处理，都当作Content-Type: text/html</li></br>
        	<li>简单的HTTP协议头有这两行就足够了，再发一个空行表示结束</li></br>
        	<li>读取文件的内容发送到客户端</li></br>
        	<li>关闭连接</li></br>
</blockquote></br>
</br>
